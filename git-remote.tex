\chapter*{Udaljeni repozitoriji}
\addcontentsline{toc}{chapter}{Udaljeni repozitoriji}

Sve ono što smo do sada proučavali smo radili isključivo na lokalnom repozitoriju.
Samo smo spomenuli da je git distribuirani sustav za verzioniranje koda, složiti ćete se da je već krajnje vrijeme da krenemo pomalo obrađivati interakciju s udaljenim repozitorijima.

Postoji puno scenarija kako može funkcionirati ta interakcija.
Koncentrirajmo se sada na sam trenutak kad repozitorij "dođe" ili "nastane" na našem lokalnom računalu.
Moguće je da smo ga stvorili od nule s \verb+git init+, na način kako smo to radili do sada i onda, na neki način, "poslali" na neku udaljenu lokaciju.
Ili smo takav repozitorij ponudili drugim ljudima da ga preuzmu (kloniraju).

No, moguće je i da smo saznali za neki već postojeći repozitorij, negdje na internetu, i sad želimo i mi preuzeti taj kod.
Bilo da je to zato što želimo pomoći u razvoju ili samo proučiti nečiji kod.
Krenimo s prvim tipičnim scenarijem\dots

\section*{Naziv i adresa repozitorija}
\addcontentsline{toc}{section}{Naziv i adresa repozitorija}

Prvu stvar koju ćemo obraditi je kloniranje udaljenog repozitorija.
No, ima prije toga jedna sitnica koju trebamo znati.
Svaki udaljeni repozitorij s kojime će git "komunicirati" mora imati svoju adresu.

Na primjer, ova knjiga "postoji" na \verb+git://github.com/tkrajina/uvod-u-git.git+, i to je jedna njega andresa.
Github\footnote{Web servis koji omogućava da držite svoje git repozitorije} omogućava da se istim repozitoriju pristupi i preko \\ \verb+https://tkrajina@github.com/tkrajina/uvod-u-git.git+.
Osim na Githubu, ona živi i na mom lokalnom računalu i u tom slučaju je njena adresa \verb+/home/puzz/projects/uvod-u-git+ (direktorij u kojemu se nalazi).

Nadalje, svaki udaljeni repozitorij ima i svoje kratko ime.
Nešto kao: \verb+origin+ ili \\ \verb+vanjin-repozitorij+ ili \verb+slobodan+ ili \verb+dalenov-repo+.
Nazivi su vaš slobodan izbor. 
Tako, ako vas četvero radi na istom projektu, njihove udaljene repozitorije možete nazvati \verb+marina+, \verb+ivan+, \verb+karla+.
I sa svakim od njih možete imati nekakvu vrstu interakcije. 
Na neke ćete slati svoje izmjene (ako imate ovlasti), a s nekih ćete preuzimati u svoj repozitorij.

\section*{Kloniranje repozitorija}
\addcontentsline{toc}{section}{Kloniranje repozitorija}

To je postupak kojim kopiramo cijeli repozitorij na nekoj udaljenoj lokaciji na naše lokalno računalo, a da bi onda s njime dalje nastavili raditi.
Postupak je jednostavan, ako znamo adresu (a moramo znati), onda\dots

\input{git_output/git_clone}

\dots{}\textbf{kopira cijeli projekt, zajedno sa cijelom poviješću} na naše računalo.
I to u direktorij \verb+uvod-u-git+.
Sad tu možemo gledati povijest, granati, \emph{commit}ati, \dots Raditi što god nas je volja s tim projektom.

Jasno, ne može bilo tko kasnije svoje izmjene poslati nazad na originalnu lokaciju. 
Za to moramo imati ovlasti, ili moramo vlasnika tog repozitorija pitati je li voljan naše izmjene preuzeti kod sebe.
O tome malo kasnije.

E, i još nešto. Sjećate se kad sam napisao da su nazivi udaljenih repozitorija vaš slobodan izbor.
Nisam baš bio $100\%$ iskren. 
Kloniranje je izuzetak.
Ukoliko kloniramo udaljeni repozitorij, on se za nas zove \verb+origin+.
Ostali repozitoriji koje ćemo dodavati mogu imati nazive kakve god želimo.

\subsection*{Struktura kloniranog repozitorija}
\addcontentsline{toc}{subsection}{Struktura kloniranog repozitorija}

Od trenutka kad smo klonirali svoj repozitorij pa na dalje -- za nas postoje \textbf{dva repozitorija}.
Možda negdje na svijetu postoji još netko tko je klonirao taj isti repozitorij i na njemu nešto radi (a da mi o tome ništa ne znamo).
No, naš dio svijeta su samo ova dva s kojima direktno imamo posla. 
Jedan je udaljeno kojeg smo klonirali, a drugi je lokalni koji se nalazi pred nama.

Prije negoli počnemo s pričom o tome kako slati ili primati izmjene iz jednog repozitorija u drugi, trebamo nakratko spomenuti kakva je točno struktura lokalnog repozitorija.
Već znamo za naredbu \verb+git branch+, koja nam ispisuje spisak svih grana na našem repozitoriju.
No, sad imamo posla i sa udaljenim repozitorijem -- njega smo klonirali.

S \verb+git branch -a+ ispisujemo \textbf{sve grane koje su nam trenutno dostupne u lokalnom rpeozitoriju}.
Naime, kad smo klonirali repozitorij -- postale su nam dostupne i grane udaljenog repozitorija:

\input{git_output/git_branch_all_1}

Novost ovdje je \verb+remotes/origin/master+.
Prvo, ovo \verb+remotes/+ znači da, iako toj grani imamo pristup na lokalnom repozitoriju, ona je \textbf{samo kopija grane} \verb+master+ \textbf{u repozitoriju} \verb+origin+.
Takve kopije udaljenih repozitorija ćemo uvijek označavati s \\ \verb+<naziv_repozitorija>/<naziv_grane>+.
Konkretno, ovdje je to \verb+origin/master+.

Dakle, grafički bi to mogli prikazati ovako:

\input{graphs/origin_master}

Imamo dva repozitorija, lokalni i udaljeni.
Udaljeni ima samo granu \verb+master+, a lokalni ima dvije kopije te grane. 
U lokalnom \verb+master+ ćemo mi \emph{commit}ati naše izmjene, a u \verb+origin/master+ se nalazi kopija udaljenog \verb+origin/master+ u koju \textbf{nećemo} \emph{commit}ati.
Ovaj \verb+origin/master+ ćemo, s vremenena na vrijeme, osvježavati tako da imamo ažurno stanje udaljenog repozitorija.

Ako vam ovo zvuči zbunjujuće, vjerujte niste jedini koje ovo zbunjuje.
No, sve će sjesti na svoje mjesto kad to počnete koristiti.

\section*{Kloniranje, grane i povijest udaljenog repozitorija}
\addcontentsline{toc}{section}{Kloniranje, grane i povijest udaljenog repozitorija}

Naš lokalni repozitorij može imati svoje grane, a onaj udaljeni svoje.
Već znamo koristiti naredbu za rad s granama -- \verb+git branch+, ali ona nam daje samo spisak grana u našem repozitoriju.
Ništa nam ne govori o granama na udaljenom repozitoriju, barem ne ako ga koristimo onako kako smo ga sad koristili.
S \verb+git branch -a+ dobiti ćemo spisak svih grana kojima imamo trenutno pristup.

To su sve \textbf{naše grane}, ali \textbf{i grane udaljenih repozitorija} koje trenutno imamo konfigurirane.
Za sada je jedini takav udaljeni repozitorij naš \verb+origin+:

\input{git_output/git_branch_all_1}

Ovaj ispis znači da u \textbf{našem lokalnom} repozitoriju imamo samo jednu granu -- \verb+master+, dok u udaljenom \verb+origin+ (onom kojeg smo klonirali) imamo isto \verb+master+.
Zapamtite, udaljene grane se uvijek referenciraju s \verb+<naziv_repozitorija>/<naziv_grane>+. 
Zatrebamo li raditi nešto s udaljenim \verb+master+ repozitorijem, onda ćemo ga pisati kao \verb+origin/master+.

U trenutku kad kloniramo udaljeni repozitorij, git će lokalno upamtiti sve grane koje se na njemu nalaze.

%\input{git_output/git_branch_all_2}

\section*{Fetch}
\addcontentsline{toc}{section}{Fetch}

Treba imati na umu jednu stvar, svaki git repozitorij ima jednog ili više vlasnika.
Kad kloniramo repozitorij, dobili smo njegovu kopiju na našem računalu i sad u njega možemo \emph{commit}ati.
Ta kopija neće uvijek biti ažurna.

\section*{Push}
\addcontentsline{toc}{section}{Push}

\section*{Pull}
\addcontentsline{toc}{section}{Pull}

\section*{Rad s granama}
\addcontentsline{toc}{section}{Rad s granama}

\section*{Udaljeni repozitoriji}
\addcontentsline{toc}{section}{Udaljeni repozitoriji}

\subsection*{Djelomično kloniranje povijesti repozitorija}
\addcontentsline{toc}{subsection}{Djelomično kloniranje povijesti repozitorija}

Našli ste na internetu neki zanimljiv projekt i njegov git repozitorij i htjeli bi ga skinuti i proučiti njegov kod. 
Ništa lakše; \verb+git clone ...+.

E, ali\dots
Tu imamo mali problem.
Git repozitorij sadrži cijelu povijest projekta. 
To znači da sadrži sve \emph{commit}ove koje su radili programeri i koji mogu sezati i preko deset godina unazad.
I zato \verb+git clone+ ponekad može potrajati dosta dugo. 
Posebno ako imate sporu vezu.

No, postoji trik.
Želimo li skinuti projekt samo zato da bi pogledali njegov kod a ne zanima nas cijela njegova povijest -- moguće je klonirati samo nekoliko njegovih zadnjih \emph{commit}ova s:

\gitoutputcommand{git clone --depth 5 --no-hardlinks git://github.com/tkrajina/uvod-u-git.git}

To će biti puno brže, no nećete imati pristup cijeloj povijesti, nego samo zadnjih $5$ \emph{commit}ova.

\TODO: Ograničenja takvog kloniranja

tagovi, \dots

\TODO "Bare" repozitorij

%\section*{}
%\addcontentsline{toc}{section}{}

